!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports={oauthd_url:"{{auth_url}}",oauthd_api:"{{api_url}}",version:"web-0.1.7",options:{}}},{}],2:[function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m;m=a("../tools/sha1"),e=a("../config"),f=a("../tools/datastore")(e),c=a("../tools/url")(),h={request:{}},l={},k={},j={execProvidersCb:function(a,b,c){var d,e;if(k[a]){d=k[a],delete k[a];for(e in d)d[e](b,c)}},getDescription:function(a,b,c){return b=b||{},"object"==typeof l[a]?c(null,l[a]):(l[a]||j.fetchDescription(a),b.wait?(k[a]=k[a]||[],void k[a].push(c)):c(null,{}))}},e.oauthd_base=c.getAbsUrl(e.oauthd_url).match(/^.{2,5}:\/\/[^/]+/)[0],d=[],g=void 0,(i=function(){var a,b;b=/[\\#&]oauthio=([^&]*)/.exec(document.location.hash),b&&(document.location.hash=document.location.hash.replace(/&?oauthio=[^&]*/,""),g=decodeURIComponent(b[1].replace(/\+/g," ")),a=f.cookies.readCookie("oauthio_state"),a&&(d.push(a),f.cookies.eraseCookie("oauthio_state")))})(),b.exports=function(b){var i,k,n,o;i=function(b){h.request=a("./oauthio_requests")(b,e,d,f),j.fetchDescription=function(a){l[a]||(l[a]=!0,b.ajax({url:e.oauthd_base+e.oauthd_api+"/providers/"+a,data:{extend:!0},dataType:"json"}).done(function(b){l[a]=b.data,j.execProvidersCb(a,null,b.data)}).always(function(){"object"!=typeof l[a]&&(delete l[a],j.execProvidersCb(a,new Error("Unable to fetch request description")))}))}},b.OAuth||(b.OAuth={initialize:function(a,b){var c;if(e.key=a,b)for(c in b)e.options[c]=b[c]},setOAuthdURL:function(a){e.oauthd_url=a,e.oauthd_base=c.getAbsUrl(e.oauthd_url).match(/^.{2,5}:\/\/[^/]+/)[0]},getVersion:function(){return e.version},create:function(a,b,c){var d,e,g,i;if(!b)return f.cache.tryCache(a,!0);"object"!=typeof c&&j.fetchDescription(a),e=function(d){return h.request.mkHttp(a,b,c,d)},g=function(a,d){return h.request.mkHttpEndpoint(data.provider,b,c,a,d)},i={};for(d in b)i[d]=b[d];return i.get=e("GET"),i.post=e("POST"),i.put=e("PUT"),i.patch=e("PATCH"),i.del=e("DELETE"),i.me=function(){h.request.mkHttpMe(data.provider,b,c,"GET")},i},popup:function(a,b,g){var i,j,k,l,n,o,p,q,r;return k=function(a){if(a.origin===e.oauthd_base){try{o.close()}catch(c){}return b.data=a.data,h.request.sendCallback(b,i)}},o=void 0,j=void 0,p=void 0,i=$.Deferred(),b=b||{},e.key?(2===arguments.length&&(g=b,b={}),f.cache.cacheEnabled(b.cache)&&(l=f.cache.tryCache(a,b.cache))?(i.resolve(l),g?g(null,l):void 0):(b.state||(b.state=m.create_hash(),b.state_type="client"),d.push(b.state),n=e.oauthd_url+"/auth/"+a+"?k="+e.key,n+="&d="+encodeURIComponent(c.getAbsUrl("/")),b&&(n+="&opts="+encodeURIComponent(JSON.stringify(b))),r={width:Math.floor(.8*window.outerWidth),height:Math.floor(.5*window.outerHeight)},r.height<350&&(r.height=350),r.width<800&&(r.width=800),r.left=window.screenX+(window.outerWidth-r.width)/2,r.top=window.screenY+(window.outerHeight-r.height)/8,q="width="+r.width+",height="+r.height,q+=",toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0",q+=",left="+r.left+",top="+r.top,b={provider:a,cache:b.cache},b.callback=function(a,c){return window.removeEventListener?window.removeEventListener("message",k,!1):window.detachEvent?window.detachEvent("onmessage",k):document.detachEvent&&document.detachEvent("onmessage",k),b.callback=function(){},p&&(clearTimeout(p),p=void 0),g?g(a,c):void 0},window.attachEvent?window.attachEvent("onmessage",k):document.attachEvent?document.attachEvent("onmessage",k):window.addEventListener&&window.addEventListener("message",k,!1),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.onMessageExternal&&chrome.runtime.onMessageExternal.addListener(function(a,b){return a.origin=b.url.match(/^.{2,5}:\/\/[^/]+/)[0],i.resolve(),k(a)}),!j&&(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(j=document.createElement("iframe"),j.src=e.oauthd_url+"/auth/iframe?d="+encodeURIComponent(c.getAbsUrl("/")),j.width=0,j.height=0,j.frameBorder=0,j.style.visibility="hidden",document.body.appendChild(j)),p=setTimeout(function(){i.reject(new Error("Authorization timed out")),b.callback&&b.callback(new Error("Authorization timed out"));try{o.close()}catch(a){}},12e5),o=window.open(n,"Authorization",q),o?o.focus():(i.reject(new Error("Could not open a popup")),b.callback&&b.callback(new Error("Could not open a popup"))),i.promise())):(i.rejet(new Error("OAuth object must be initialized")),g(new Error("OAuth object must be initialized")))},redirect:function(a,b,d){var g,h;return 2===arguments.length&&(d=b,b={}),f.cache.cacheEnabled(b.cache)&&(h=f.cache.tryCache(a,b.cache))?(d=c.getAbsUrl(d)+(-1===d.indexOf("#")?"#":"&")+"oauthio=cache",document.location.href=d,void document.location.reload()):(b.state||(b.state=m.create_hash(),b.state_type="client"),f.cookies.createCookie("oauthio_state",b.state),g=encodeURIComponent(c.getAbsUrl(d)),d=e.oauthd_url+"/auth/"+a+"?k="+e.key,d+="&redirect_uri="+g,b&&(d+="&opts="+encodeURIComponent(JSON.stringify(b))),void(document.location.href=d))},callback:function(a,b,c){var d;if(1===arguments.length&&(c=a,a=void 0,b={}),2===arguments.length&&(c=b,b={}),f.cache.cacheEnabled(b.cache)||"cache"===g){if("cache"===g&&("string"!=typeof a||!a))return c(new Error("You must set a provider when using the cache"));if(d=f.cache.tryCache(a,b.cache))return c(null,d)}g&&h.request.sendCallback({data:g,provider:a,cache:b.cache,callback:c})},clearCache:function(a){f.cookies.eraseCookie("oauthio_provider_"+a)},http_me:function(a){h.request.http_me&&h.request.http_me(a)},http:function(a){h.request.http&&h.request.http(a)}},"undefined"==typeof jQuery?(o=[],k=void 0,"undefined"!=typeof chrome&&chrome.runtime?k=function(){return function(){throw new Error("Please include jQuery before oauth.js")}}:(n=document.createElement("script"),n.src="//code.jquery.com/jquery.min.js",n.type="text/javascript",n.onload=function(){var a;i(jQuery);for(a in o)o[a].fn.apply(null,o[a].args)},document.getElementsByTagName("head")[0].appendChild(n),k=function(a){return function(){var b,c;c=[];for(b in arguments)c[b]=arguments[b];o.push({fn:a,args:c})}}),h.request.http=k(function(){h.request.http.apply(b.OAuth,arguments)}),j.fetchDescription=k(function(){j.fetchDescription.apply(j,arguments)}),h.request=a("./oauthio_requests")(jQuery,e,d,f)):i(jQuery))}},{"../config":1,"../tools/datastore":5,"../tools/sha1":6,"../tools/url":7,"./oauthio_requests":3}],3:[function(a,b){var c,d=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=a("../tools/url")(),b.exports=function(a,b,e,f){return{http:function(e){var f,g,h,i,j;h=function(){var e,f,g,h;if(h=j.oauthio.request||{},!h.cors){j.url=encodeURIComponent(j.url),"/"!==j.url[0]&&(j.url="/"+j.url),j.url=b.oauthd_url+"/request/"+j.oauthio.provider+j.url,j.headers=j.headers||{},j.headers.oauthio="k="+b.key,j.oauthio.tokens.oauth_token&&j.oauthio.tokens.oauth_token_secret&&(j.headers.oauthio+="&oauthv=1");for(f in j.oauthio.tokens)j.headers.oauthio+="&"+encodeURIComponent(f)+"="+encodeURIComponent(j.oauthio.tokens[f]);return delete j.oauthio,a.ajax(j)}if(j.oauthio.tokens){if(j.oauthio.tokens.access_token&&(j.oauthio.tokens.token=j.oauthio.tokens.access_token),j.url.match(/^[a-z]{2,16}:\/\//)||("/"!==j.url[0]&&(j.url="/"+j.url),j.url=h.url+j.url),j.url=c.replaceParam(j.url,j.oauthio.tokens,h.parameters),h.query){g=[];for(e in h.query)g.push(encodeURIComponent(e)+"="+encodeURIComponent(c.replaceParam(h.query[e],j.oauthio.tokens,h.parameters)));j.url+=d.call(j.url,"?")>=0?"&"+g:"?"+g}if(h.headers){j.headers=j.headers||{};for(e in h.headers)j.headers[e]=c.replaceParam(h.headers[e],j.oauthio.tokens,h.parameters)}return delete j.oauthio,console.log(j),a.ajax(j)}},j={},i=void 0;for(i in e)j[i]=e[i];return j.oauthio.request&&j.oauthio.request!==!0?h():(g={wait:!!j.oauthio.request},f=a.Deferred(),providers_api.getDescription(j.oauthio.provider,g,function(a,b){return a?f.reject(a):(j.oauthio.request=j.oauthio.tokens.oauth_token&&j.oauthio.tokens.oauth_token_secret?b.oauth1&&b.oauth1.request:b.oauth2&&b.oauth2.request,void f.resolve())}),f.then(h))},http_me:function(c){var d,e,f,g,h;f=function(){var c,d,e,f;c=a.Deferred(),f=h.oauthio.request||{},h.url=b.oauthd_url+"/auth/"+h.oauthio.provider+"/me",h.headers=h.headers||{},h.headers.oauthio="k="+b.key,h.oauthio.tokens.oauth_token&&h.oauthio.tokens.oauth_token_secret&&(h.headers.oauthio+="&oauthv=1");for(d in h.oauthio.tokens)h.headers.oauthio+="&"+encodeURIComponent(d)+"="+encodeURIComponent(h.oauthio.tokens[d]);return delete h.oauthio,e=a.ajax(h),a.when(e).done(function(a){c.resolve(a.data)}).fail(function(a){c.reject(a.responseJSON?a.responseJSON.data:new Error("An error occured while trying to access the resource"))}),c.promise()},h={};for(g in c)h[g]=c[g];return h.oauthio.request&&h.oauthio.request!==!0?f():(e={wait:!!h.oauthio.request},d=a.Deferred(),providers_api.getDescription(h.oauthio.provider,e,function(a,b){return a?d.reject(a):(h.oauthio.request=h.oauthio.tokens.oauth_token&&h.oauthio.tokens.oauth_token_secret?b.oauth1&&b.oauth1.request:b.oauth2&&b.oauth2.request,void d.resolve())}),d.then(f))},mkHttp:function(a,b,c,d){var e;return e=this,function(f,g){var h,i;if(i={},"string"==typeof f){if("object"==typeof g)for(h in g)i[h]=g[h];i.url=f}else if("object"==typeof f)for(h in f)i[h]=f[h];return i.type=i.type||d,i.oauthio={provider:a,tokens:b,request:c},e.http(i)}},mkHttpMe:function(a,b,c,d){var e;return e=this,function(f){var g;return g={},g.type=g.type||d,g.oauthio={provider:a,tokens:b,request:c},g.data=g.data||{},g.data.filter=f?f.join(","):void 0,e.http_me(g)}},sendCallback:function(a,b){var c,d,g,h,i,j,k,l,m;c=this,d=void 0,h=void 0;try{d=JSON.parse(a.data)}catch(n){return g=n,b.reject(new Error("Error while parsing result")),a.callback(new Error("Error while parsing result"))}if(d&&d.provider&&(!a.provider||d.provider.toLowerCase()===a.provider.toLowerCase())){if("error"===d.status||"fail"===d.status)return h=new Error(d.message),h.body=d.data,b.reject(h),a.callback?a.callback(h):void 0;if("success"!==d.status||!d.data)return h=new Error,h.body=d.data,b.reject(h),a.callback?a.callback(h):void 0;if(!d.state||-1===e.indexOf(d.state))return b.reject(new Error("State is not matching")),a.callback?a.callback(new Error("State is not matching")):void 0;if(a.provider||(d.data.provider=d.provider),l=d.data,f.cache.cacheEnabled(a.cache)&&l&&f.cache.storeCache(d.provider,l),k=l.request,delete l.request,m=void 0,l.access_token?m={access_token:l.access_token}:l.oauth_token&&l.oauth_token_secret&&(m={oauth_token:l.oauth_token,oauth_token_secret:l.oauth_token_secret}),!k)return b.resolve(l),a.callback?a.callback(null,l):void 0;if(k.required)for(i in k.required)m[k.required[i]]=l[k.required[i]];return j=function(a){return c.mkHttp(d.provider,m,k,a)},l.get=j("GET"),l.post=j("POST"),l.put=j("PUT"),l.patch=j("PATCH"),l.del=j("DELETE"),l.me=c.mkHttpMe(d.provider,m,k,"GET"),b.resolve(l),a.callback?a.callback(null,l):void 0}}}}},{"../tools/url":7}],4:[function(a){a("./lib/oauth")(window||this)},{"./lib/oauth":2}],5:[function(a,b,c){b.exports=function(a){return{cookies:{createCookie:function(a,b,c){var d;eraseCookie(a),d=new Date,d.setTime(d.getTime()+1e3*(c||1200)),c="; expires="+d.toGMTString(),document.cookie=a+"="+b+c+"; path=/"},readCookie:function(a){var b,c,d,e;for(e=a+"=",c=document.cookie.split(";"),d=0;d<c.length;){for(b=c[d];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(e))return b.substring(e.length,b.length);d++}return null},eraseCookie:function(a){var b;b=new Date,b.setTime(b.getTime()-864e5),document.cookie=a+"=; expires="+b.toGMTString()+"; path=/"}},cache:{tryCache:function(a,b){var d,e,f;if(cacheEnabled(b)){if(b=readCookie("oauthio_provider_"+a),!b)return!1;b=decodeURIComponent(b)}if("string"==typeof b)try{b=JSON.parse(b)}catch(g){return d=g,!1}if("object"==typeof b){f={};for(e in b)"request"!==e&&"function"!=typeof b[e]&&(f[e]=b[e]);return c.OAuth.create(a,f,b.request)}return!1},storeCache:function(a,b){createCookie("oauthio_provider_"+a,encodeURIComponent(JSON.stringify(b)),b.expires_in-10||3600)},cacheEnabled:function(b){return"undefined"==typeof b?a.options.cache:b}}}}},{}],6:[function(a,b){var c,d;d=0,c="",b.exports={hex_sha1:function(a){return this.rstr2hex(this.rstr_sha1(this.str2rstr_utf8(a)))},b64_sha1:function(a){return this.rstr2b64(this.rstr_sha1(this.str2rstr_utf8(a)))},any_sha1:function(a,b){return this.rstr2any(this.rstr_sha1(this.str2rstr_utf8(a)),b)},hex_hmac_sha1:function(a,b){return this.rstr2hex(this.rstr_hmac_sha1(this.str2rstr_utf8(a),this.str2rstr_utf8(b)))},b64_hmac_sha1:function(a,b){return this.rstr2b64(this.rstr_hmac_sha1(this.str2rstr_utf8(a),this.str2rstr_utf8(b)))},any_hmac_sha1:function(a,b,c){return this.rstr2any(this.rstr_hmac_sha1(this.str2rstr_utf8(a),this.str2rstr_utf8(b)),c)},sha1_vm_test:function(){return"a9993e364706816aba3e25717850c26c9cd0d89d"===thishex_sha1("abc").toLowerCase()},rstr_sha1:function(a){return this.binb2rstr(this.binb_sha1(this.rstr2binb(a),8*a.length))},rstr_hmac_sha1:function(a,b){var c,d,e,f,g;for(c=this.rstr2binb(a),c.length>16&&(c=this.binb_sha1(c,8*a.length)),f=Array(16),g=Array(16),e=0;16>e;)f[e]=909522486^c[e],g[e]=1549556828^c[e],e++;return d=this.binb_sha1(f.concat(this.rstr2binb(b)),512+8*b.length),this.binb2rstr(this.binb_sha1(g.concat(d),672))},rstr2hex:function(a){var b,c,e,f,g;try{}catch(h){b=h,d=0}for(c=d?"0123456789ABCDEF":"0123456789abcdef",f="",g=void 0,e=0;e<a.length;)g=a.charCodeAt(e),f+=c.charAt(g>>>4&15)+c.charAt(15&g),e++;return f},rstr2b64:function(a){var b,d,e,f,g,h,i;try{}catch(j){b=j,c=""}for(h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g="",f=a.length,d=0;f>d;){for(i=a.charCodeAt(d)<<16|(f>d+1?a.charCodeAt(d+1)<<8:0)|(f>d+2?a.charCodeAt(d+2):0),e=0;4>e;)g+=8*d+6*e>8*a.length?c:h.charAt(i>>>6*(3-e)&63),e++;d+=3}return g},rstr2any:function(a,b){var c,d,e,f,g,h,i,j,k;for(d=b.length,j=Array(),f=void 0,h=void 0,k=void 0,i=void 0,c=Array(Math.ceil(a.length/2)),f=0;f<c.length;)c[f]=a.charCodeAt(2*f)<<8|a.charCodeAt(2*f+1),f++;for(;c.length>0;){for(i=Array(),k=0,f=0;f<c.length;)k=(k<<16)+c[f],h=Math.floor(k/d),k-=h*d,(i.length>0||h>0)&&(i[i.length]=h),f++;j[j.length]=k,c=i}for(g="",f=j.length-1;f>=0;)g+=b.charAt(j[f]),f--;for(e=Math.ceil(8*a.length/(Math.log(b.length)/Math.log(2))),f=g.length;e>f;)g=b[0]+g,f++;return g},str2rstr_utf8:function(a){var b,c,d,e;for(c="",b=-1,d=void 0,e=void 0;++b<a.length;)d=a.charCodeAt(b),e=b+1<a.length?a.charCodeAt(b+1):0,d>=55296&&56319>=d&&e>=56320&&57343>=e&&(d=65536+((1023&d)<<10)+(1023&e),b++),127>=d?c+=String.fromCharCode(d):2047>=d?c+=String.fromCharCode(192|d>>>6&31,128|63&d):65535>=d?c+=String.fromCharCode(224|d>>>12&15,128|d>>>6&63,128|63&d):2097151>=d&&(c+=String.fromCharCode(240|d>>>18&7,128|d>>>12&63,128|d>>>6&63,128|63&d));return c},str2rstr_utf16le:function(a){var b,c;for(c="",b=0;b<a.length;)c+=String.fromCharCode(255&a.charCodeAt(b),a.charCodeAt(b)>>>8&255),b++;return c},str2rstr_utf16be:function(a){var b,c;for(c="",b=0;b<a.length;)c+=String.fromCharCode(a.charCodeAt(b)>>>8&255,255&a.charCodeAt(b)),b++;return c},rstr2binb:function(a){var b,c;for(c=Array(a.length>>2),b=0;b<c.length;)c[b]=0,b++;for(b=0;b<8*a.length;)c[b>>5]|=(255&a.charCodeAt(b/8))<<24-b%32,b+=8;return c},binb2rstr:function(a){var b,c;for(c="",b=0;b<32*a.length;)c+=String.fromCharCode(a[b>>5]>>>24-b%32&255),b+=8;return c},binb_sha1:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b,p=Array(80),c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=-1009589776,h=0;h<a.length;){for(j=c,k=d,l=e,m=f,n=g,i=0;80>i;)p[i]=16>i?a[h+i]:this.bit_rol(p[i-3]^p[i-8]^p[i-14]^p[i-16],1),o=this.safe_add(this.safe_add(this.bit_rol(c,5),this.sha1_ft(i,d,e,f)),this.safe_add(this.safe_add(g,p[i]),this.sha1_kt(i))),g=f,f=e,e=this.bit_rol(d,30),d=c,c=o,i++;c=this.safe_add(c,j),d=this.safe_add(d,k),e=this.safe_add(e,l),f=this.safe_add(f,m),g=this.safe_add(g,n),h+=16}return Array(c,d,e,f,g)},sha1_ft:function(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d},sha1_kt:function(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514},safe_add:function(a,b){var c,d;return c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16),d<<16|65535&c},bit_rol:function(a,b){return a<<b|a>>>32-b},create_hash:function(){var a;return a=this.b64_sha1((new Date).getTime()+":"+Math.floor(9999999*Math.random())),a.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}}},{}],7:[function(a,b){b.exports=function(){return{getAbsUrl:function(a){var b;return a.match(/^.{2,5}:\/\//)?a:"/"===a[0]?document.location.protocol+"//"+document.location.host+a:(b=document.location.protocol+"//"+document.location.host+document.location.pathname,"/"!==b[b.length-1]&&"#"!==a[0]?b+"/"+a:b+a)},replaceParam:function(a,b,c){return a=a.replace(/\{\{(.*?)\}\}/g,function(a,c){return b[c]||""}),c&&(a=a.replace(/\{(.*?)\}/g,function(a,b){return c[b]||""})),a}}}},{}]},{},[4]);